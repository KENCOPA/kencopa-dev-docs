---
type: note
moc: "[[🏷️ADR]]"
tags:
- '#ai/ref'
---
# 📜 文脈・背景
日報機能において、ユーザーは工程管理データから自動生成される画像（工程表、ドリリングチャート、出来高進捗率チャート）に加えて、現場写真やドキュメントファイル（画像、Excel、PDF等）を手動でアップロードし、メールに添付する必要がある。

現在のシステムでは安全パトロール画像のアップロード機能が既に実装されており、同様の仕組み（Cognito経由でS3への直接アップロード）を使用する予定である。

ファイルアップロード機能に求められる要件：
- ドラッグ&ドロップによる直感的な操作性
- 複数ファイルの一括アップロード対応
- ファイル形式・サイズの制限機能
- プログレス表示とエラーハンドリング
- 既存のS3アップロード機能との統合
- レスポンシブデザイン対応

## 🎨 対応案

### 案1: react-dropzoneライブラリを使用

**メリット**：

- ドラッグ&ドロップ機能の簡単な実装
- ファイル形式・サイズ制限の組み込み機能
- 豊富なカスタマイズオプション
- 優れたアクセシビリティサポート
- TypeScript対応
- 軽量（gzip圧縮後約10KB）

**デメリット**：

- 新しい依存関係の追加
- shadcn/uiとのスタイル統合が必要

### 案2: ネイティブHTML5 File APIを使用

**メリット**：

- 外部依存関係なし
- 完全なカスタム制御

**デメリット**：

- ドラッグ&ドロップ機能の複雑な実装が必要
- ファイル検証ロジックの自作が必要
- アクセシビリティ対応の工数増加
- ブラウザ互換性の考慮が必要

### 案3: 他のファイルアップロードライブラリ（react-uploady等）

**メリット**：

- 高機能なアップロード制御

**デメリット**：

- バンドルサイズが大きい
- オーバースペック
- 学習コストが高い

## 🚀 決定

日報メールのファイルアップロード機能にreact-dropzoneライブラリを使用する。

理由：

- ドラッグ&ドロップによる優れたUXを簡単に実装できる
- ファイル形式・サイズ制限などの必要機能が組み込まれている
- TypeScript対応により型安全性が確保される
- 軽量でパフォーマンスへの影響が最小限
- shadcn/uiコンポーネントとの統合が可能
- アクセシビリティ要件を満たす

## 🪞 結果・影響

### プラスの結果

- **開発効率の向上**：ドラッグ&ドロップ機能を短期間で実装可能
- **優れたUX**：直感的なファイルアップロード操作を提供
- **保守性の向上**：well-maintainedなライブラリによる安定した動作
- **型安全性**：TypeScript対応によるバグの早期発見
- **アクセシビリティ**：キーボード操作やスクリーンリーダー対応

### マイナスの結果

- **依存関係の増加**：新しい外部ライブラリへの依存
- **バンドルサイズ**：約10KBの増加（gzip圧縮後）
- **学習コスト**：チームメンバーのライブラリAPI習得が必要


## 🍜 今後の検討事項

