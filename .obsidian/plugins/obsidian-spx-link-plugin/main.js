'use strict';

var obsidian = require('obsidian');

var __defProp = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
const DEFAULT_SETTINGS = {
  vaultName: "",
  spxBaseUrl: "https://spx.vercel.app/1/"
};
class SpxLinkPlugin extends obsidian.Plugin {
  constructor() {
    super(...arguments);
    __publicField(this, "settings", DEFAULT_SETTINGS);
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new SpxSettingTab(this.app, this));
    this.addCommand({
      id: "copy-spx-link",
      name: "Copy SPX-wrapped Obsidian URL",
      hotkeys: [
        { modifiers: ["Ctrl", "Meta"], key: "c" }
        // Cmd+Ctrl+C
      ],
      callback: async () => {
        const file = this.app.workspace.getActiveFile();
        if (!(file instanceof obsidian.TFile)) {
          new obsidian.Notice("No active note to copy URL from.");
          return;
        }
        if (!this.settings.vaultName) {
          new obsidian.Notice("Please set your Vault name in plugin settings.");
          return;
        }
        const filePath = encodeURIComponent(file.path);
        const uri = `obsidian://open?vault=${encodeURIComponent(
          this.settings.vaultName
        )}&file=${filePath}`;
        try {
          const spxLink = `${this.settings.spxBaseUrl}/${encodeURIComponent(
            uri
          )}`;
          await navigator.clipboard.writeText(spxLink);
          new obsidian.Notice("Copied SPX link to clipboard!");
        } catch (error) {
          new obsidian.Notice("Failed to create SPX link. Please check your settings.");
          console.error(error);
        }
      }
    });
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
}
class SpxSettingTab extends obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    __publicField(this, "plugin");
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "SPX Link Copier Settings" });
    new obsidian.Setting(containerEl).setName("Vault Name").setDesc("Name of your Obsidian vault (case-sensitive)").addText(
      (text) => text.setPlaceholder("MyVault").setValue(this.plugin.settings.vaultName).onChange(async (value) => {
        this.plugin.settings.vaultName = value.trim();
        await this.plugin.saveSettings();
      })
    );
    new obsidian.Setting(containerEl).setName("SPX Base URL").setDesc("Base URL of your SPX proxy (e.g. https://spx.vercel.app)").addText(
      (text) => text.setPlaceholder(DEFAULT_SETTINGS.spxBaseUrl).setValue(this.plugin.settings.spxBaseUrl).onChange(async (value) => {
        this.plugin.settings.spxBaseUrl = value.trim().replace(/\/$/, "");
        await this.plugin.saveSettings();
      })
    );
  }
}

module.exports = SpxLinkPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsiLi4vc3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQXBwLFxuICBQbHVnaW4sXG4gIFBsdWdpblNldHRpbmdUYWIsXG4gIFNldHRpbmcsXG4gIE5vdGljZSxcbiAgVEZpbGUsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbnRlcmZhY2UgU3B4U2V0dGluZ3Mge1xuICB2YXVsdE5hbWU6IHN0cmluZztcbiAgc3B4QmFzZVVybDogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBTcHhTZXR0aW5ncyA9IHtcbiAgdmF1bHROYW1lOiBcIlwiLFxuICBzcHhCYXNlVXJsOiBcImh0dHBzOi8vc3B4LnZlcmNlbC5hcHAvMS9cIixcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNweExpbmtQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICBzZXR0aW5nczogU3B4U2V0dGluZ3MgPSBERUZBVUxUX1NFVFRJTkdTO1xuXG4gIGFzeW5jIG9ubG9hZCgpIHtcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU3B4U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgIGlkOiBcImNvcHktc3B4LWxpbmtcIixcbiAgICAgIG5hbWU6IFwiQ29weSBTUFgtd3JhcHBlZCBPYnNpZGlhbiBVUkxcIixcbiAgICAgIGhvdGtleXM6IFtcbiAgICAgICAgeyBtb2RpZmllcnM6IFtcIkN0cmxcIiwgXCJNZXRhXCJdLCBrZXk6IFwiY1wiIH0sIC8vIENtZCtDdHJsK0NcbiAgICAgIF0sXG4gICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgbm90ZSB0byBjb3B5IFVSTCBmcm9tLlwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLnZhdWx0TmFtZSkge1xuICAgICAgICAgIG5ldyBOb3RpY2UoXCJQbGVhc2Ugc2V0IHlvdXIgVmF1bHQgbmFtZSBpbiBwbHVnaW4gc2V0dGluZ3MuXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGVuY29kZVVSSUNvbXBvbmVudChmaWxlLnBhdGgpO1xuICAgICAgICBjb25zdCB1cmkgPSBgb2JzaWRpYW46Ly9vcGVuP3ZhdWx0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIHRoaXMuc2V0dGluZ3MudmF1bHROYW1lXG4gICAgICAgICl9JmZpbGU9JHtmaWxlUGF0aH1gO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgc3B4TGluayA9IGAke3RoaXMuc2V0dGluZ3Muc3B4QmFzZVVybH0vJHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgICB1cmlcbiAgICAgICAgICApfWA7XG4gICAgICAgICAgYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoc3B4TGluayk7XG4gICAgICAgICAgbmV3IE5vdGljZShcIkNvcGllZCBTUFggbGluayB0byBjbGlwYm9hcmQhXCIpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gY3JlYXRlIFNQWCBsaW5rLiBQbGVhc2UgY2hlY2sgeW91ciBzZXR0aW5ncy5cIik7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBvbnVubG9hZCgpIHt9XG5cbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gIH1cbn1cblxuY2xhc3MgU3B4U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IFNweExpbmtQbHVnaW47XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogU3B4TGlua1BsdWdpbikge1xuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiU1BYIExpbmsgQ29waWVyIFNldHRpbmdzXCIgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiVmF1bHQgTmFtZVwiKVxuICAgICAgLnNldERlc2MoXCJOYW1lIG9mIHlvdXIgT2JzaWRpYW4gdmF1bHQgKGNhc2Utc2Vuc2l0aXZlKVwiKVxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIHRleHRcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJNeVZhdWx0XCIpXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnZhdWx0TmFtZSlcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy52YXVsdE5hbWUgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICB9KVxuICAgICAgKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJTUFggQmFzZSBVUkxcIilcbiAgICAgIC5zZXREZXNjKFwiQmFzZSBVUkwgb2YgeW91ciBTUFggcHJveHkgKGUuZy4gaHR0cHM6Ly9zcHgudmVyY2VsLmFwcClcIilcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxuICAgICAgICB0ZXh0XG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKERFRkFVTFRfU0VUVElOR1Muc3B4QmFzZVVybClcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3B4QmFzZVVybClcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcHhCYXNlVXJsID0gdmFsdWUudHJpbSgpLnJlcGxhY2UoL1xcLyQvLCBcIlwiKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIH0pXG4gICAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiUGx1Z2luIiwiVEZpbGUiLCJOb3RpY2UiLCJQbHVnaW5TZXR0aW5nVGFiIiwiU2V0dGluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQWNBLE1BQU0sZ0JBQWdDLEdBQUE7QUFBQSxFQUNwQyxTQUFXLEVBQUEsRUFBQTtBQUFBLEVBQ1gsVUFBWSxFQUFBO0FBQ2QsQ0FBQTtBQUVBLE1BQXFCLHNCQUFzQkEsZUFBTyxDQUFBO0FBQUEsRUFBbEQsV0FBQSxHQUFBO0FBQUEsSUFBQSxLQUFBLENBQUEsR0FBQSxTQUFBLENBQUE7QUFDRSxJQUF3QixhQUFBLENBQUEsSUFBQSxFQUFBLFVBQUEsRUFBQSxnQkFBQSxDQUFBO0FBQUE7QUFBQSxFQUV4QixNQUFNLE1BQVMsR0FBQTtBQUNiLElBQUEsTUFBTSxL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
