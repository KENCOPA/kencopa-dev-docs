---
type: note
moc: "[[ðŸ·ï¸åŸºæœ¬è¨­è¨ˆæ›¸]]"
---
> [!info] å¿…è¦ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠžã—ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ï¼

# æ¦‚è¦

**Agent ã®å¿œç­”é€Ÿåº¦ï¼ˆLatencyï¼‰ã‚’æ§‹æˆè¦ç´ ã”ã¨ã«åˆ†è§£ã—ã€ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’ç‰¹å®šã—ãŸ**ã€‚
å¯¾è±¡ã¯ä¸»ã«ä»¥ä¸‹ã® 4 ã¤ã® Agentï¼š

- Goal Agent
- Plan Agent
- Delegator Agent
- ConstructionKnowledgeAgentï¼ˆï¼‹ SiteKnowledgeAgentï¼‰

Langfuse ãƒˆãƒ¬ãƒ¼ã‚¹ï¼ˆ[Sample1](https://us.cloud.langfuse.com/project/cm9sdhfkd0062ad08ijc9tvcm/traces/0199179ff8d6d4bdb6841484344b2178?display=preview&observation=4cc2ab5226484773)ãƒ»[Sample2](https://us.cloud.langfuse.com/project/cm9sdhfkd0062ad08ijc9tvcm/traces/019917925f3f298f82bbf6f9dfa92fa5?observation=d1982179ba0f90d1&timestamp=2025-09-05T01:51:32.671Z)ï¼‰ã‚’ã‚‚ã¨ã«ã€ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã‚„ LLM ãƒ¢ãƒ‡ãƒ«ã”ã¨ã®å‡¦ç†æ™‚é–“ã‚’åˆ†æžã€‚

# èª¿æŸ»çµæžœ

## 1. **LLM å‘¼ã³å‡ºã—å›žæ•°ãŒå¤šã„**

- Goal Agentï¼Plan Agent ã§ã¯ **ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®ãƒ•ãƒ­ãƒ¼ãŒå›ºå®šçš„** ã§ã‚ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€
  Agent SDK ã®ä»•æ§˜ã«ã‚ˆã‚Š **æ¯Žå›žã€Œæ¬¡ã«ã©ã®ãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã¶ã‹ã€ã‚’ LLM ãŒåˆ¤æ–­**ã—ã¦ã„ã‚‹ã€‚
- ãã®ãŸã‚ã€LLM å‘¼ã³å‡ºã—ãŒå¤šããªã‚Šã€å¿œç­”å…¨ä½“ã® Latency å¢—å¤§ã«ã¤ãªãŒã£ã¦ã„ã‚‹ã€‚

ä¾‹ï¼š

- Goal Agent ã§ Responses API ãŒè¤‡æ•°å›žï¼ˆ6ã€œ7 ç§’ Ã— 3 å›žï¼‰
- Plan Agent ã§ o3 ãƒ¢ãƒ‡ãƒ«ã‚’ 3 å›žå‘¼ã³å‡ºã—ï¼ˆè¨ˆ 27ã€œ36 ç§’ï¼‰

---

## 2. **Plan Agent ã® modelã€Œo3ã€ã¯æ€è€ƒæ™‚é–“ãŒé•·ã„**

- Plan Agent ã§ã¯ `o3` ãƒ¢ãƒ‡ãƒ«ä½¿ç”¨æ™‚ã« 1 å›žã‚ãŸã‚Š 10ã€œ13 ç§’ä»¥ä¸Šã®æŽ¨è«–æ™‚é–“ã€‚
  ã“ã‚Œã¯ `gpt-4.1` ã¨æ¯”ã¹ã¦ç´„ 1.5ã€œ2 å€é…ã„ã€‚
- å„ Responses API å‘¼ã³å‡ºã—ã§ 8ã€œ13 ç§’ç¨‹åº¦ã®é…å»¶ã€‚

---

## 3. **ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ï¼ˆretrieve_with_bedrockï¼‰ã®å¤šé‡å‘¼ã³å‡ºã—**

- ConstructionKnowledgeAgentï¼SiteKnowledgeAgent ã«ã¦
  `retrieve_with_bedrock` ãŒ **1 ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ 3ã€œ4 å›žå®Ÿè¡Œ**ã€‚
- å„å‘¼ã³å‡ºã—ã« 3ã€œ5 ç§’ã‹ã‹ã‚Šã€åˆè¨ˆã§ 15ã€œ20 ç§’ä»¥ä¸Šã®é…å»¶ã‚’ç”Ÿã‚“ã§ã„ã‚‹ã€‚

---

## 4. **Delegator Agent å…¨ä½“ã§ã®ç· Latency**

- Delegator Agent ãŒå„ä¸‹ä½ Agentï¼ˆGoal, Plan, Knowledge ç­‰ï¼‰ã‚’é †æ¬¡å‘¼ã³å‡ºã™ãŸã‚ã€
  å…¨ä½“ã§ **1 åˆ†åŠã€œ3 åˆ†åŠè¶…** ã®ç· Latency ã«ã€‚
- ç‰¹ã« KnowledgeAgent éƒ¨åˆ†ãŒé•·æ™‚é–“åŒ–ï¼ˆ1ã€œ2 åˆ†è¶…ï¼‰ã€‚

---

## ã‚µãƒ³ãƒ—ãƒ«ã®é›†è¨ˆã‚µãƒžãƒªãƒ¼

| Agent               | ä¸»ãªå‡¦ç†            | æ‰€è¦æ™‚é–“       | ä¸»ãªé…å»¶è¦å›                        |
| ------------------- | ------------------- | -------------- | ---------------------------------- |
| **Goal Agent**      | gpt-4.1 å‘¼ã³å‡ºã— Ã—3 | ç´„ 20ã€œ27s     | æ¯Žå›ž LLM çµŒç”±ã§ãƒ•ãƒ­ãƒ¼æ±ºå®š          |
| **Plan Agent**      | o3 å‘¼ã³å‡ºã— Ã—3      | ç´„ 27ã€œ36s     | ãƒ¢ãƒ‡ãƒ«æ€è€ƒæ™‚é–“ãŒé•·ã„               |
| **Delegator Agent** | ä¸‹ä½ Agent çµ±æ‹¬     | ç´„ 1.5ã€œ3.5 åˆ† | å„ Agent ç›´åˆ—å®Ÿè¡Œ                  |
| **Knowledge Agent** | ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ Ã—3ã€œ4  | ç´„ 45ã€œ120s    | retrieve_with_bedrock å¤šé‡å‘¼ã³å‡ºã— |

# ä»Šå¾Œã®æ–¹é‡ãƒ»æ”¹å–„ç­–

| å¯¾å¿œé …ç›®                                | æ–¹é‡                                                                                                                                                                                                                    | å·¥æ•°     |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| **1. Agent SDK ã‹ã‚‰ LangGrpah ã«ç§»è¡Œã™ã‚‹** | Agent SDK ã®ä»•æ§˜ã«ã‚ˆã‚Šæ¬¡ã®ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®æ±ºå®šã‚’ LLM çµŒç”±ã§åˆ¤å®šã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã§ãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã¶ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®éƒ¨åˆ†ã¯ä¸è¦ãª LLM å‘¼ã³å‡ºã—ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã€‚LangGrpah ã«ç§»è¡Œã™ã‚‹ã“ã¨ã§ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã§ tool å‘¼ã³å‡ºã—ãŒå¯èƒ½ã«ãªã‚Šã€ä¸è¦ãª LLM ã®å‘¼ã³å‡ºã—ãŒãªããªã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚                                                | 24-40h |
| **2. ãƒ¢ãƒ‡ãƒ«é¸å®šã®è¦‹ç›´ã—**                    | ç¾åœ¨ã€åˆ©ç”¨ã—ã¦ã„ã‚‹ LLM ã®ãƒ¢ãƒ‡ãƒ«ã¯ gpt-4.1ã€gpt-o3 ã§ã‚ã‚‹ãŒã€ãƒ™ã‚¹ãƒˆãªãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠžã—ã¦ã„ã‚‹ã¨ã¯è¨€ãˆãªã„ã€‚ä»£æ›¿æ¡ˆã¨ã—ã¦ GPT-5 miniã€Gemini 2.5ã€grok ãªã©ãŒã‚ã‚‹ã®ã§ã€OpenRouter ã‚’ä½¿ç”¨ã—ã¦è¤‡æ•°ãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã™ã‚‹ã€‚                                                                              | 16-24h |
| **3. ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢å›žæ•°ã®æœ€é©åŒ–**                 | Site Knowledge Agentã€Tenant Knowledge Agent ãŒãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã™ã‚‹éš›ã« `retrieve_with_bedrock` ãŒå¹³å‡ã§ 3ã€œ4 å›žå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ãŸã‚æ¤œç´¢æ™‚é–“ãŒé•·ããªã£ã¦ã„ã‚‹ã€‚ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã®å‘¼ã³å‡ºã—å›žæ•°ã‚’ä¸¦åˆ—å‡¦ç†ã«ã—ã¦ã€æ¤œç´¢å›žæ•°ã‚’ 1 å›žã«åˆ¶é™ã™ã‚‹ã€‚                                                                 | 16-24h |
| **4. Knowledge Agent ã®ä¸¦åˆ—åŒ–ã®æ¤œè¨Ž**      | å„ Knowledge Agent ã¯ä»–ã® Knowledge Agent ã‚’ç‹¬ç«‹ã—ã¦ã„ã‚‹ã®ã§ç›´åˆ—å‡¦ç†ã‹ã‚‰ä¸¦åˆ—å‡¦ç†ã«ã™ã‚‹ã€‚                                                                                                                                                         | 16-24h |
| **5. Agent ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¦‹ç›´ã—**            | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›å†…å®¹ã«é–¢ã‚ã‚‰ãšã€Goal Agent â†’ Plan Agent â†’ Delegator Agentâ€¦ã®ã‚ˆã†ã«è¤‡æ•°ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚Site Knowledge Agentã€Tenant Knowledge Agent ãªã©ãŒä¸è¦ãªã‚±ãƒ¼ã‚¹ã§ã¯ Goal Agent ã§ç›´æŽ¥ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¾…ã¡æ™‚é–“ã‚’çŸ­ç¸®ã§ãã‚‹ã€‚Agent ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¿œã˜ã¦ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æœ€é©åŒ–ã™ã‚‹ã€‚ | 8-16h  |

---

## ã‚¿ã‚¹ã‚¯ã®ä¾å­˜é–¢ä¿‚

```mermaid
graph TD;
    F[OpenRouter ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ»ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒæ¤œè¨¼];
    A[Agent SDK ã‹ã‚‰ LangGraph ã¸ç§»è¡Œ];
    B[é¸æŠžã—ãŸãƒ¢ãƒ‡ãƒ«ã®é©ç”¨];
    F --> B;
    A --> B;
    A --> C[ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢å›žæ•°ã®æœ€é©åŒ–];
    A --> D[Knowledge Agent ã®ä¸¦åˆ—åŒ–æ¤œè¨Ž];
    A --> E[Agent ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¦‹ç›´ã—];
    C -- ãƒãƒƒãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹å¯èƒ½æ€§ã‚ã‚Š--> D;
    D -- ãƒãƒƒãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹å¯èƒ½æ€§ã‚ã‚Š--> C;
```
