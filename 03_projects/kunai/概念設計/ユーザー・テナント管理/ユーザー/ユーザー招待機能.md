---
type: note
moc: "[[🏷️概念設計書]]"
---


# ユーザー招待機能

## 全体概要

### 概要

テナントに新しいユーザーを追加するための機能群。
既存ユーザーの追加と新規ユーザーの招待の両方に対応し、ロールと上限（ユーザー数・ゲスト数）を満たす範囲で参加を完了させる。

### ビジネス目標

* 組織拡張時のオンボーディングを素早く安全に実施する
* 認可境界（管理者/メンバー/ゲスト）と契約上限を担保しつつ、招待運用の手戻りを減らす
* 監査可能な履歴を残し、コンプライアンスと説明責任を満たす

### 全体受け入れ条件

* 管理者は管理者/メンバー/ゲストを招待できる
* メンバーはゲストのみ招待できる
* 招待はユーザー数上限・ゲスト上限を超えない範囲で完了できる
* 招待の再送・取り消し・期限切れが適切に扱われ、履歴が残る

---

## テナントへのユーザー招待機能

### ステータス

* [x] 検討中
* [x] 概念設計中
* [ ] 概念設計確定
* [ ] 実装中
* [ ] 実装完了
* [ ] 不採用

### 機能概要

メールアドレスとロールを指定して招待を作成し、受信者がリンクから参加手続きを完了する。
既存アカウントは即テナント紐付け、新規はアカウント作成を経て参加する。

### ビジネス目標

* 招待作成から参加完了までの手数を最小化する
* 誤招待や上限超過を事前に防ぎ、サポート負荷を下げる

### 機能要件（ユーザーストーリー形式）

* 管理者は管理者/メンバー/ゲストを招待できる
* メンバーはゲストのみ招待できる（管理者/メンバーの招待は不可）
* 既存ユーザーのメールを指定すると、そのユーザーをテナントに追加できる
* 未登録メールを指定した場合、受信者はアカウント作成後にテナントへ参加できる
* 招待時に指定したロールは、参加完了時点の上限チェックに合格した場合にのみ確定する
* 招待リンクの有効期限は既定30日

### 例外・ガード

* 最終管理者が1名のみの状態で、その管理者をゲスト化/削除する招待操作は不可
* 管理者/メンバー枠が満杯の場合、ゲスト招待のみ許可（理由を明示）
* ドメイン許可リストが設定されている場合、対象外ドメインへの招待は不可（理由を明示）

---

## 招待管理機能

### ステータス

* [x] 検討中
* [x] 概念設計中
* [ ] 概念設計確定
* [ ] 実装中
* [ ] 実装完了
* [ ] 不採用

### 機能概要

作成済み招待の一覧表示、再送、取り消し、有効期限の管理を行う。

### 機能要件（ユーザーストーリー形式）

* システム管理者・メンバーは全ての招待の一覧を閲覧できる（宛先、ロール、作成者、有効期限、状態）
* システム管理者は任意の招待を再送/取り消しできる
* メンバーは自身が作成したゲスト招待を再送/取り消しできる
* 期限切れ招待は状態が「期限切れ」となり、再発行または再送の導線を提示する
* 取り消し済み招待は無効化され、リンクアクセス時に無効メッセージを表示する


