---
type: note
moc: "[[🏷️概念設計書]]"
---


# ユーザー数制御機能

## 全体概要

### 概要

契約に応じて利用可能なユーザー数（管理者＋メンバー）を制御する機能。
管理者は最低1人必須。
ゲストは契約数に含めず、固定上限（100人）まで「閲覧＋コメント専用」として利用できる。

### ビジネス目標

* 分かりやすい料金体系
  契約＝「ユーザー数」で明快に定義し、現場監督や管理者が直感的に理解できるようにする
* 柔軟な共有と拡張
  ゲストを契約外で受け入れ、社内外への展開を促進する
* 契約整合と透明性
  利用人数と課金を正しく一致させ、監査対応を容易にする
* 運用リスクの低減
  最終管理者の削除禁止、上限超過ガードでトラブルを未然に防ぐ

---

## 認可モデル

* ロール：3種

  * システム管理者

    * 契約・請求、テナント設定、ユーザー管理が可能
    * メンバー権限をすべて含む
    * 管理者／メンバー／ゲストの追加・削除・ロール変更が可能
    * 最後の管理者を削除・降格することは不可

  * メンバー

    * 日常業務（編集、AI利用、現場作成・管理など）が可能
    * ゲストの招待・削除・復元が可能
    * 管理者やメンバーの追加・削除・ロール変更は不可

  * ゲスト

    * 閲覧とコメントのみ可能
    * 編集、設定、契約関連操作は不可
    * 招待上限は固定（100人）、契約数には含まれない

* 契約カウント

  * ユーザー数 ＝ 管理者＋メンバーの合計
  * ゲストは契約数に含めない

* 必須制約

  * 管理者は常に1人以上（最終管理者の降格・削除は不可）

---

## ステータス

* [x] 検討中
* [x] 概念設計中
* [ ] 概念設計確定
* [ ] 実装中
* [ ] 実装完了
* [ ] 不採用

---

## 機能概要

契約で決まる上限ユーザー数（=管理者＋メンバー）の範囲で、ユーザーを追加・ロール変更できる。
ゲストは固定上限100人まで追加可能で、閲覧＋コメントのみ利用可能。
UI・用語は「ユーザー数」で統一し、「シート／ライセンス」は表に出さない。

---

## 機能要件（ユーザーストーリー）

* システム管理者は、契約上限内で管理者／メンバーを追加できる
* システム管理者は、全ユーザーのロールを管理者／メンバー／ゲストに変更できる（最終管理者の降格は不可）
* システム管理者は、任意のユーザーを削除・復元できる
* メンバーは、ゲストのみ招待できる
* メンバーは、ゲストを削除・復元できる
* ゲストは契約外で追加可能（上限100人）で、閲覧＋コメントのみ利用できる
* システムは、上限超過となる追加・ロール昇格をブロックし、アップグレード導線を提示できる
* システムは、現在数／上限を常時UI表示する（例：`ユーザー 18 / 20`）
* システムは、最終管理者の降格・削除を禁止する（警告文言を明示）

