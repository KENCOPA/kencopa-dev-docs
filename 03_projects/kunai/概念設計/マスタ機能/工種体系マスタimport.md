# 工種体系マスタ インポート・エクスポート機能

## 全体概要

### 概要

本設計書は、工種体系マスタ（大分類／工種／細別）と、それに紐づく作業日数・歩掛データを取り扱う一連の管理機能を対象とする。
主な構成は以下の3機能である。

* 工種体系マスタインポート機能
* 工種体系マスタエクスポート機能
* デフォルトデータ作成機能（建築・土木）

これらは、CS導入時に各社の既存データを効率的に移行し、初期セットアップを迅速化するための基盤として開発する。インポート／エクスポートを通じて工種体系の標準化を支援し、建築・土木領域それぞれで共通的に利用可能なデフォルトデータを整備する。

### ビジネス目標
* 初期セットアップの効率化：CS担当者による手動登録作業を自動化し、導入初期の立ち上げ時間を短縮する。
* データ構造の統一：インポート／エクスポートの標準フォーマットを通じて、異なる企業・拠点間でデータ構造を共通化する。
* 標準データの提供：建築・土木の代表的な工種体系と日数・歩掛をプリセットとして提供し、導入初期から利用可能にする。
* 継続運用の容易化：マスタ更新、バックアップ、共有を容易にし、長期的なデータ管理コストを低減する。

### 全体受け入れ条件

* CS担当者は、提供されたテンプレートを使って工種体系・日数・歩掛をまとめてインポートできる。
* ユーザーは、既存の工種体系マスタを同一テンプレート形式でエクスポートできる。
* 開発担当者は、インポート／エクスポートに用いる標準フォーマットを決定し、テンプレートとして提供できる。
* システムは、建築・土木それぞれの代表的な工種体系データをデフォルトとして登録できる。

---

## 工種体系マスタインポート機能

### ステータス

* [x] 検討中
* [x] 概念設計中
* [ ] 概念設計確定
* [ ] 実装中
* [ ] 実装完了

### 機能概要

3階層（大分類→工種→細別）の体系ツリーと、細別に紐づく作業日数および歩掛データをまとめて取り込み、新しい工種体系マスタとして登録する機能。
差分更新ではなく、常に新規マスタとして作成される。
インポート形式は XLSX、CSV、JSON などを候補とし、最終的に運用負荷が最も小さく、エラーが起きにくい形式を採用する。

### ビジネス目標

* 顧客企業ごとに異なる工種体系を短時間で登録し、現場適用までのリードタイムを短縮する。
* 手動でのマスタ作成に伴うヒューマンエラーを削減し、CS導入の安定性を高める。

### 機能要件（ユーザーストーリー形式）

#### インポート方式を決定する

* 開発担当者は、最もミスが少なく運用コストの低い形式（例：XLSX、CSV、JSON のいずれか）を選定し、システムに適用する。
* 選定結果はテンプレート仕様としてCS担当者に共有される。

#### CS担当者はテンプレートに3階層ツリーと細別の日数・歩掛を記入できる

* CS担当者は、提供されたテンプレートに沿って大分類、工種、細別、および細別に対応する日数や歩掛を入力できる。
* 入力内容はテンプレート仕様のバリデーション条件に従う。

#### システムは新しい工種体系マスタを作成できる

* システムは、取り込みデータを検証した上で、新規の工種体系マスタを作成できる。


---
## エクスポート機能

### ステータス

* [x] 検討中
* [x] 概念設計中
* [ ] 概念設計確定
* [ ] 実装中
* [ ] 実装完了

### 機能概要

登録済みの工種体系マスタを、所定のテンプレート形式（インポートと同一仕様）でエクスポートする機能。出力には大分類・工種・細別の階層構造、および細別に紐づく作業日数・歩掛データを含める。

### ビジネス目標

* バックアップや顧客データ共有の効率化。
* データ更新時の再インポート作業を簡略化し、メンテナンスコストを削減する。

### 機能要件（ユーザーストーリー形式）

#### ユーザーは登録済みの工種体系マスタをエクスポートできる

* ユーザーは、対象の工種体系マスタを選択し、ファイル形式（XLSX または CSV）を指定してエクスポートできる。

#### システムは階層構造を保持したテンプレート形式で出力できる

* システムは、大分類・工種・細別・日数・歩掛をテンプレート準拠の列構造で出力する。
* 出力ファイルはそのまま再インポート可能なフォーマットとする。

---
## デフォルトデータ作成機能（建築・土木）

### ステータス

* [x] 検討中
* [x] 概念設計中
* [ ] 概念設計確定
* [ ] 実装中
* [ ] 実装完了

### 機能概要

建築および土木の代表的な工種体系をベースに、基本的な作業日数と歩掛データを整理・データ化する機能。
作成したデータは、テナント作成時に自動的にシステムへ登録され、初期シードデータとして利用される。
複雑な条件分岐や詳細な分類は省き、一般的な利用に耐える標準的な構成を目指す。

### ビジネス目標

* 初期導入時にすぐ利用可能な体系を提供し、セットアップ作業を簡略化する。
* 公開されている積算基準や標準仕様をベースに整備し、信頼性と汎用性を確保する。
* 各社のカスタマイズや拡張の基礎となる標準データを整備する。

### 機能要件（ユーザーストーリー形式）

#### 建築デフォルトデータ作成

* 担当者は、建築積算基準や建築工事標準仕様書を参照し、主要な工事区分（躯体・仕上・設備関連など）を体系化できる。
* 担当者は、大分類・工種・細別の階層構造を作成し、代表的な作業日数と歩掛データを付与できる。
* 登録するデータは、RC構造、鉄骨造、内装仕上などの主要工種を中心とした一般的な内容とする。
* システムは、作成されたデータをテンプレート形式（インポート用）で出力し、初期シードとして登録できる。

#### 土木デフォルトデータ作成

* 担当者は、土木積算基準（土木工事標準積算基準書など）および土木工事体系ツリーを参照し、主要な工種区分（道路・橋梁・河川・構造物など）を体系化できる。
* 担当者は、大分類・工種・細別の階層構造を作成し、代表的な作業日数と歩掛データを付与できる。
* 登録するデータは、舗装工事、擁壁工事、橋台基礎工事など、汎用的な現場で使用される項目を中心とする。
* システムは、作成されたデータをテンプレート形式（インポート用）で出力し、初期シードとして登録できる。



