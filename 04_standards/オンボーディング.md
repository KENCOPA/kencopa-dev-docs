---
type: note
---
# 📌 目的・対象範囲

- **目的**
  - 新規参画メンバーが開発業務を開始するために必要なツールアクセス権限の取得と環境構築を行う
- **対象範囲**
  - KENCOPA 新規参画メンバー

# 🚩 前提条件

手順を実施する前に満たしておくべき条件を記載します。

- KENCOPA 業務用メールアドレスが発行済み
- Slack アカウントが作成済み
- [全社向けオンボーディングマニュアル](https://www.notion.so/ac770c75273b4b389f4984738cf97fb9?pvs=21)を確認済み

# 🛠 使用するツール・環境

- AWS（クラウドインフラ・サーバー環境）
- Github（ソースコード管理・バージョン管理）
- Linear（プロジェクト管理・タスク管理）
- Obsidian（ナレッジ管理・ドキュメント管理）
- Devin（AI 開発アシスタント・コードレビュー）
- Google SSO
- Docker
- Node.js / yarn

# 📋 実施手順

## ① 開発で利用するツールのアクセス確認

### AWS

AWS は Google SSO でアクセス（Terraform で管理）

1. [infra レポジトリ](https://github.com/KENCOPA/infra)を clone
2. 新規 feature ブランチを作成（例: `feature/add-taro-tanaka`）
3. `google-workspace/group.yaml`の`aws-sso-azuchi-admin`に自分のメールアドレスを追加
4. commit & push し、Pull Request を作成

   ```markdown
   ## Background

   ---

   KENCOPA 新規参画

   ## What

   ---

   Admin に xxx を追加

   ## Review Point

   ---
   ```

5. Pull Request 承認後、Google メニューから Amazon Web Services にアクセスできることを確認
   ![[Pasted image 20250607114013.png]]
   ![[Pasted image 20250607114050.png]]

### Github

1. Github アカウントを準備
   - KENCOPA 業務アドレスで新規アカウント作成 または 既存アカウントを使用
2. Github アカウントをとしさん（[@としさん](https://kencopahq.slack.com/team/U07UP1HJUJ0)）に Slack で連携
3. 招待メールが届くのでアクセスできることを確認

### Linear

1. 業務アドレスに招待メールが送付されているため、アクセスできることを確認
2. メールが届いていない場合は、プロジェクトマネージャーに Slack で連絡
3. Linear にログインしてワークスペースにアクセスできることを確認

### Obsidian

1. [Obsidian 公式サイト](https://obsidian.md/download)から Obsidian アプリケーションをダウンロード・インストール
2. [kc-dev-documents リポジトリ](https://github.com/KENCOPA/kc-dev-documents)を clone
3. Obsidian で clone したフォルダを Vault として開く
4. ドキュメントにアクセスできることを確認

### Devin

1. Slack の `pd-azuchi-with-devin` チャンネルにアクセス権限を確認
2. Devin を使用したコードレビューの流れを確認
   - PR 作成後、以下のコマンドで Devin にレビュー依頼
   ```
   @Devin
   !PR
   PRのURL
   ```

> [!tip]
> コードのキャッチアップには devin Search を積極的に使おう！

## ② ローカル環境の構築

### Git のインストール・設定

1. **Git のインストール**

   - [Git 公式サイト](https://git-scm.com/downloads)から使用している OS に対応した Git をダウンロード・インストール
   - ターミナルで `git --version` を実行し、正常にインストールされていることを確認

2. **SSH キーの設定**
   - [GitHub の SSH キー設定ガイド](https://docs.github.com/ja/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent)に従って SSH キーを生成・設定
   - 生成した SSH キーを GitHub アカウントに追加

### Docker のインストール

1. [Docker 公式サイト](https://www.docker.com/get-started)にアクセス
2. 使用している OS に対応した Docker Desktop をダウンロード・インストール
3. インストール完了後、Docker Desktop を起動
4. ターミナルで `docker --version` を実行し、正常にインストールされていることを確認

### Node.js のインストール（任意）

> [!info]
> Docker を利用するため、ローカル環境に Node.js を導入する必要はありません。念の為、Docker と同じ環境をローカルにも準備したい人はこの手順を実施してください。

#### Node.js バージョン管理ツールの導入

1. **Volta のインストール**（推奨）

   ```bash
   # Volta をインストール
   curl https://get.volta.sh | bash

   # Node.js 22.6 をインストール
   volta install node@22.6

   # バージョン確認
   node --version
   npm --version
   ```

2. **Yarn v4 の導入**

   ```bash
   # corepack をインストール
   npm install -g corepack

   # corepack を有効化
   corepack enable

   # Yarn v4 をインストール
   volta install yarn@4

   # バージョン確認
   yarn --version
   ```

#### 参考リンク

- [Volta 公式サイト](https://volta.sh/)
- [Node.js リリース情報](https://nodejs.org/en/about/previous-releases)

### 基本セットアップ

1. [kc-bootstrap](https://github.com/KENCOPA/kc-bootstrap)の手順を実行

### AWS SSO 連携

下記のコマンドを実行

```shell
$> sso-azuchi
```

1. `SSO session name`: 空のままで OK
2. `SSO start URL`: 手順 ① で確認した AWS アクセスポータルの URL
3. `SSO region`: `ap-northeast-1`を指定
4. 画面上で AWS 認証を許可
5. 対象環境を選択（SANDBOX が DEV 環境）
6. `Default client Region`、`CLI default output format`: 空のままで OK
7. `echo $AWS_PROFILE`で`KC_AZUCHI`が表示されることを確認

### フロントエンド・バックエンド環境構築

1. [azuchi-frontend](https://github.com/KENCOPA/azuchi-frontend)をセットアップ
   - ルート直下で`make bootstrap`を実行
2. [azuchi-backend](https://github.com/KENCOPA/azuchi-backend)をセットアップ
   - ルート直下で`make bootstrap`を実行
   - 初回は時間がかかるため、コンテナログ（make log）で処理完了を確認してから再実行

### Azuchi アカウント作成

#### owner を招待

1. **Swagger の管理画面にアクセス**

   - **Stage 環境**: https://core-api.azuchi.kencopa.click/api/swagger
   - **Dev 環境**: https://core-api.azuchi-dev.kencopa.click/api/swagger
   - **Local 環境**: http://localhost:8787/api/swagger

2. **会社を作成**

   - `/api/v1/companies` を呼び出して会社作成
   - 法人番号は[法人番号生成ツール](https://corporate-number-generator-app-xpm6.vercel.app/)を使用
   - 0 始まりの法人番号は使用不可のため、再生成してください

3. **エラーが発生した場合の対処**

   - ローカル実行で `404: Caused by: ApplicationException: system user not found` になった場合
   - seeding がうまくいっていない可能性があるため、以下を実行
     ```bash
     make seed-dev
     ```
   - 再度 API リクエストを試してください

4. **tenantId を控える**

   - API レスポンスから `tenantId` をメモしておく

5. **owner を招待**

   - `/api/v1/invitations/owner` を呼び出す
   - `emailAddress`: 自分のメールアドレスに変更
   - `tenantId`: 先ほど控えた値に変更
   - `systemUserId`: デフォルト値で OK
   - 事前に [AWS SES](https://d-956745ad65.awsapps.com/start/#/?tab=accounts) にメールアドレスを追加しておく

6. **アカウント作成**
   - 招待メールが届くのでリンクを押してアカウント作成
   - 500 エラーの場合は SSO 認証が切れている可能性があり

# 🚧 注意事項

- BE の`make bootstrap`：初回は処理が終わる前に次に進みエラーが出る可能性あり
- VSCode 使用時：[型宣言エラー対応](https://www.notion.so/VSCode-ts-175a6190a5534943a7bf1e1a41531b28?pvs=21)が必要な場合あり

# ✅ 確認方法

- [ ] Google メニューから AWS にアクセスできる
- [ ] Github の対象リポジトリにアクセスできる
- [ ] Linear にアクセスできる
- [ ] kc-dev-documents を Obsidian Vault として開くことができる
- [ ] Slack の `pd-azuchi-with-devin` チャンネルにアクセスできる
- [ ] Git が正常にインストールされている（`git --version`で確認）
- [ ] SSH キーが Github に設定されている
- [ ] Docker が正常にインストールされている（`docker --version`で確認）
- [ ] Node.js がインストールされている（任意：`node --version`で確認）
- [ ] `echo $AWS_PROFILE`で`KC_AZUCHI`が表示される
- [ ] フロントエンド・バックエンドが正常に起動する
- [ ] Azuchi にログインできる

# 📚 関連資料・リンク

- [全社向けオンボーディングマニュアル](https://www.notion.so/ac770c75273b4b389f4984738cf97fb9?pvs=21)
- [kc-bootstrap](https://github.com/KENCOPA/kc-bootstrap)
- [azuchi-frontend](https://github.com/KENCOPA/azuchi-frontend)
- [azuchi-backend](https://github.com/KENCOPA/azuchi-backend)
- [infra](https://github.com/KENCOPA/infra)
- [参考 PR 例](https://github.com/KENCOPA/infra/pull/58)
